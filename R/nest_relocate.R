#' @importFrom dplyr enquos
#' @importFrom dplyr mutate
#' @importFrom rlang :=
#' @importFrom purrr map
#' @importFrom dplyr relocate
#' 
#' @export
nest_relocate <- function(.data, 
                          .nest_data,
                          ...,
                          .before = NULL,
                          .after = NULL) {
  
  # assertions and checks
  check_nest_data(.data, {{ .nest_data }})
  
  # tidyeval of dots
  dots <- dplyr::enquos(...)
  
  # map relocate over list-col
  dplyr::mutate(
    .data,
    "{{.nest_data}}" := purrr::map({{ .nest_data }}, ~dplyr::relocate(.x, !!!dots, .before = {{ .before }}, .after = {{ .after }}))
  )
  
}